\input{../common/header}

\title{Nix simplified grammar}
\begin{document}

\maketitle{}

\par{expressions}

\begin{grammar}
  \bfseries
  <e> ::=
    \x/ \| \c/
    \alt \e/.\a/ \| \e/.\a/ or \e/
    \alt \p/:\e/ \| \e/ \e/
    \alt \{ \e/ = \e/ ; $\cdots{}$; \e/ = \e/; \}
    \alt with \e/; \e/
    \alt if \e/ then \e/ else \e/
    \alt let \x/ = \e/; $\cdots{}$; \x/ = \e/; in \e/
    \alt Cons(\e/, \e/) \| nil
    \alt \o/

    <o> ::= attrNames(\e/) \| listToAttrs(\e/)
    \alt addAttr(\e/, \e/, \e/) \| removeAttr(\e/, \e/)
    % Not as-if in nix, but simpler than the actual builtins ("//" or
    % removeAttrs), and yet sufficient thanks to attrNames and listToAttrs
    \alt deepSeq(\e/, \e/) \| seq(\e/, \e/)
    \alt functionArgs(\e/)
    % Maybe this can be typed as a function, but it is rather unlikely

  <a> ::= \b/. $\cdots{}$ .\b/

  <b> ::= \$\{\e/\} \| \meta{l}

  <c> ::= \meta{s} \| \meta{i} \| $\cdots{}$
    \alt typeOf
    \alt $\cdots{}$

  <p> ::= \q/ \| \q/@\x/ \| \x/

  <q> ::= \{ \f/, $\cdots{}$, \f/ \} \| \{ \f/, $\cdots{}$, \f/ , \ldots{}\}
    \alt Cons(\x/, \x/) \| nil
    \alt \c/

  <f> ::= \x/ \| \x/ ? \e/

\end{grammar}

\par{values}

\begin{grammar}
  \bfseries

  <v> ::=
    \c/
    \alt \p/:\e/
    \alt \{ \v/ = \e/; $\cdots{}$; \v/ = \e/; \}
    \alt Cons(\e/, \e/) \| nil
\end{grammar}
\end{document}
