\documentclass{article}

\usepackage{fontspec}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}

\usepackage{syntax}

\title{Nix simplified grammar}
\date{}

\renewcommand{\grammarlabel}[2]{\meta{#1 #2}}
\usepackage{xspace}

\newcommand{\meta}[1]{{\it{#1}}} % For meta syntax
\renewcommand{\|}{\textrm{|}}

\def\e/{\meta{e}}
\def\a/{\meta{a}}
\def\b/{\meta{b}}
\def\c/{\meta{c}}
\def\p/{\meta{p}}
\def\q/{\meta{q}}
\def\f/{\meta{f}}
\def\x/{\meta{x}}
\def\o/{\meta{o}}

\begin{document}

\maketitle{}

\begin{grammar}
  \bfseries
  <e> ::=
    \x/ \| \c/
    \alt \e/.\a/ \| \e/.\a/ or \e/
    \alt \p/:\e/ \| \e/ \e/
    \alt \{ \e/ = \e/; ...; \e/ = \e/; \}
    \alt with \e/; \e/
    \alt if \e/ then \e/ else \e/
    \alt let \x/ = \e/; \ldots{;} \x/ = \e/; in \e/
    \alt Cons(\e/, \e/) \| nil
    \alt \o/

    <o> ::= attrNames(\e/) \| listToAttrs(\e/)
    \alt addAttr(\e/, \e/, \e/) \| removeAttr(\e/, \e/)
    % Not as-if in nix, but simpler than the actual builtins ("//" or
    % removeAttrs), and yet sufficient thanks to attrNames and listToAttrs
    \alt deepSeq(\e/, \e/) \| seq(\e/, \e/)
    \alt functionArgs(\e/)
    % Maybe this can be typed as a function, but it is rather unlikely

  <a> ::= \b/. \ldots{} .\b/

  <b> ::= \$\{\e/\} \| \meta{l}

  <c> ::= \meta{s} \| \meta{i} \| \ldots{}
    \alt typeOf
    \alt \ldots{}

  <p> ::= \q/ \| \q/@\x/ \| \x/

  <q> ::= \{ \f/, \ldots{,} \f/ \} \| \{ \f/, \ldots{,} \f/ , ...\}

  <f> ::= \x/ \| \x/ ? \e/

\end{grammar}
\end{document}
